# üêº –û—Å–Ω–æ–≤—ã Pandas: –í–∞—à –Ω–∞–¥–µ–∂–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Python

**Pandas** ‚Äî —ç—Ç–æ –º–æ—â–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Python –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –û–Ω–∞ –Ω–µ–∑–∞–º–µ–Ω–∏–º–∞ –≤ –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏, –≥–¥–µ –¥–∞–Ω–Ω—ã–µ –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å, —á–∏—Å—Ç–∏—Ç—å –∏ –≥–æ—Ç–æ–≤–∏—Ç—å –¥–ª—è –º–æ–¥–µ–ª–µ–π. –¢—ã –æ—Å–≤–æ–∏—à—å **DataFrame**, **Series** –∏ –∫–ª—é—á–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –∞ —Ç–∞–∫–∂–µ –ø–æ–π–º—ë—à—å, –∫–∞–∫ Pandas –ø–æ–º–æ–≥–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö ML-–∑–∞–¥–∞—á–∞—Ö.

## 1. üß± –û—Å–Ω–æ–≤–∞ Pandas ‚Äî DataFrame –∏ Series

- **DataFrame**: –î–≤—É–º–µ—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏ (–∏–Ω–¥–µ–∫—Å–æ–º) –∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏. –ü—Ä–µ–¥—Å—Ç–∞–≤—å –µ—ë –∫–∞–∫ –Ω–∞–±–æ—Ä **Series**, –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã—Ö –æ–±—â–∏–º –∏–Ω–¥–µ–∫—Å–æ–º, –∏–ª–∏ –∫–∞–∫ Excel –≤ Python. –≠—Ç–æ –æ—Å–Ω–æ–≤–∞ –¥–ª—è —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ ML: CSV, SQL, —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã.
- **Series**: –û–¥–Ω–æ–º–µ—Ä–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∫–∞–∫ —Å—Ç–æ–ª–±–µ—Ü –∏–ª–∏ —Å—Ç—Ä–æ–∫–∞ DataFrame. –ò–º–µ–µ—Ç –∏–Ω–¥–µ–∫—Å (—á–∏—Å–ª–æ–≤–æ–π –∏–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π) –∏ –∏–º—è. –ü–æ—Ö–æ–∂–∞ –Ω–∞ –º–∞—Å—Å–∏–≤, –Ω–æ —Å –º–µ—Ç–∫–∞–º–∏.

**–ü—Ä–∏–º–µ—Ä**:
```
import pandas as pd
data = {'–ò–º—è': ['–ê–Ω–Ω–∞', '–ë–æ—Ä–∏—Å'], '–í–æ–∑—Ä–∞—Å—Ç': [25, 30]}
df = pd.DataFrame(data)
print(df)
```


## 2. üîë –ö–ª—é—á–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å DataFrame

### 2.1. üõ†Ô∏è –°–æ–∑–¥–∞–Ω–∏–µ –∏ —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –ò–∑ —Å–ª–æ–≤–∞—Ä–µ–π: `pd.DataFrame(dict)`.
- –ò–∑ —Ñ–∞–π–ª–æ–≤: `pd.read_csv('file.csv')`, `pd.read_json('file.json')`.
- **–ó–∞—á–µ–º**: ML –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.

**–ü—Ä–∞–∫—Ç–∏–∫–∞**: –ó–∞–≥—Ä—É–∑–∏ –¥–∞—Ç–∞—Å–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Titanic") –∏ –≤—ã–≤–µ–¥–∏ –ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫.

### 2.2. üëÄ –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö
- `.head(n)` ‚Äî –ø–µ—Ä–≤—ã–µ n —Å—Ç—Ä–æ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5).
- `.info()` ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞: —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–æ–ø—É—Å–∫–∏, –ø–∞–º—è—Ç—å. –ö–ª—é—á–µ–≤–æ–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ NaN.
- `.describe()` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–∏—Å–ª–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ (—Å—Ä–µ–¥–Ω–µ–µ, –º–∏–Ω, –º–∞–∫—Å). –ü–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω—è—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.
- `.shape` ‚Äî –∫–æ—Ä—Ç–µ–∂ (—Å—Ç—Ä–æ–∫–∏, —Å—Ç–æ–ª–±—Ü—ã).

**–ü—Ä–∏–º–µ—Ä**:
```
import pandas as pd
df = pd.DataFrame({'A': [1, 2, 3], 'B': [4.1, 5.2, 6.3]})
print(df.describe())
```

### 2.3. üóÇÔ∏è –í—ã–±–æ—Ä–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- **–°—Ç–æ–ª–±—Ü—ã**: `df['col']` (Series), `df[['col1', 'col2']]` (DataFrame).
- **–ü–æ –º–µ—Ç–∫–∞–º**: `.loc[row_labels, col_labels]` ‚Äî –≤–∫–ª—é—á–∞–µ—Ç –∫–æ–Ω–µ—Ü –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞.
- **–ü–æ –∏–Ω–¥–µ–∫—Å–∞–º**: `.iloc[row_idx, col_idx]` ‚Äî –∫–∞–∫ Python slicing.
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: `df[df['A'] > 2]` ‚Äî –±—É–ª–µ–≤–∞ –º–∞—Å–∫–∞. –ò—Å–ø–æ–ª—å–∑—É–π `&` (–ò), `|` (–ò–õ–ò), `~` (–ù–ï) —Å `()`.

**–°–≤—è–∑—å —Å ML**: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–µ–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ train/test:
```
import pandas as pd
df = pd.DataFrame({'Age': [25, 35, 20, 40]})
train = df[df['Age'] < 30]
test = df[df['Age'] >= 30]
print("Train:\n", train)
print("Test:\n", test)
```

### 2.4. ‚ûó –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- `.groupby('col')` ‚Äî –¥–µ–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ –≥—Ä—É–ø–ø—ã –ø–æ —Å—Ç–æ–ª–±—Ü—É.
- `.agg()` ‚Äî –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏: `'mean'`, `'sum'`, —Å–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–π –∏–ª–∏ —Å–ª–æ–≤–∞—Ä—å `{col: func}`.
- **–ó–∞—á–µ–º**: –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –∏ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.

**–ü—Ä–∏–º–µ—Ä**:
```
import pandas as pd
data = {'–ö–∞—Ç–µ–≥–æ—Ä–∏—è': ['A', 'B', 'A', 'B'], '–ó–Ω–∞—á–µ–Ω–∏–µ': [10, 20, 15, 25]}
df = pd.DataFrame(data)
grouped = df.groupby('–ö–∞—Ç–µ–≥–æ—Ä–∏—è')['–ó–Ω–∞—á–µ–Ω–∏–µ'].mean()
print(grouped)
```

### 2.5. ‚ûï –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
- `df['new_col'] = df['col1'] + df['col2']` ‚Äî –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –∏–ª–∏ —É—Å–ª–æ–≤–∏—è.
- **–ó–∞—á–µ–º**: Feature engineering –¥–ª—è ML.

**–ü—Ä–∏–º–µ—Ä**:
```
import pandas as pd
data = {'col1': [1, 2, 3], 'col2': [4, 5, 6]}
df = pd.DataFrame(data)
df['col3'] = df['col1'] + df['col2']
print(df)
```

### 2.6. ‚öôÔ∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–ü—Ä–æ–ø—É—Å–∫–∏**: `.isnull()` (–ø—Ä–æ–≤–µ—Ä–∫–∞), `.fillna(value)` (–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ), `.dropna()` (—É–¥–∞–ª–µ–Ω–∏–µ).
- **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏**: `.astype('category')`, `.value_counts()` (—á–∞—Å—Ç–æ—Ç–∞ –∑–Ω–∞—á–µ–Ω–∏–π).
- **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞**: `.sort_values('col')`.
- **–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ**: `pd.concat([df1, df2], axis=0)` (–ø–æ —Å—Ç—Ä–æ–∫–∞–º), `pd.merge(df1, df2, on='key', how='inner')` (JOIN –∫–∞–∫ –≤ SQL).

## 3. üßπ –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è ML

### 3.1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤
- –ó–∞–ø–æ–ª–Ω—è–π —Å—Ä–µ–¥–Ω–∏–º: `df['col'].fillna(df['col'].mean())`.
- **–ó–∞—á–µ–º**: –ú–æ–¥–µ–ª–∏ –≤—Ä–æ–¥–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å NaN.

**–ü—Ä–∏–º–µ—Ä**:
```
import pandas as pd
import numpy as np
data = {'Age': [25, np.nan, 35]}
df = pd.DataFrame(data)
df['Age'] = df['Age'].fillna(df['Age'].mean())
print(df)
```

### 3.2. –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- **Label Encoding**: —á–∏—Å–ª–æ–≤—ã–µ –º–µ—Ç–∫–∏ –¥–ª—è –ø–æ—Ä—è–¥–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "low" ‚Üí 0, "high" ‚Üí 1).
- **One-Hot Encoding**: –±–∏–Ω–∞—Ä–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
```
import pandas as pd
data = {'City': ['Moscow', 'SPb', 'Moscow']}
df = pd.DataFrame(data)
df_encoded = pd.get_dummies(df, columns=['City'])
print(df_encoded)
```
# City ‚Üí City_Moscow, City_SPb

**–ó–∞—á–µ–º**: –ú–æ–¥–µ–ª–∏ –ø–æ–Ω–∏–º–∞—é—Ç —á–∏—Å–ª–∞, –∞ –Ω–µ —Å—Ç—Ä–æ–∫–∏.

### 3.3. –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è**: `(x - mean) / std`.
```
import pandas as pd
data = {'Age': [20, 30, 40]}
df = pd.DataFrame(data)
df['Age_scaled'] = (df['Age'] - df['Age'].mean()) / df['Age'].std()
print(df)
```
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**: `(x - min) / (max - min)`.

**–ó–∞—á–µ–º**: –£—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –º–∞—Å—à—Ç–∞–±—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–≤–æ–∑—Ä–∞—Å—Ç 0-100, –¥–æ—Ö–æ–¥ 0-100000), —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å –Ω–µÂÅèÂêë (–Ω–µÂÅèÂêë ‚Äî –Ω–µ –æ—Ç–¥–∞–≤–∞—Ç—å –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ).

## 4. üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Pandas

- **–ü—Ä–æ–±–ª–µ–º–∞**: –¶–∏–∫–ª—ã –º–µ–¥–ª–µ–Ω–Ω—ã–µ –Ω–∞ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
- **–†–µ—à–µ–Ω–∏–µ**: –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è ‚Äî –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –≤—Å–µ–π Series —Å—Ä–∞–∑—É.
```
import pandas as pd
df = pd.DataFrame({'A': [1, 2, 3]})
# –ü–ª–æ—Ö–æ:
for i in range(len(df)):
    df.iloc[i, 0] *= 2
# –•–æ—Ä–æ—à–æ:
df['A'] *= 2  # –í 100 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ!
print(df)
```

**–ó–∞—á–µ–º**: ML —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –º–∏–ª–ª–∏–æ–Ω–∞–º–∏ —Å—Ç—Ä–æ–∫.

## 5. ü§î –ó–∞—á–µ–º Pandas –Ω—É–∂–µ–Ω –≤ –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏?

- **–ó–∞–≥—Ä—É–∑–∫–∞**: –ß–∏—Ç–∞–µ—Ç CSV, JSON, SQL.
- **–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞**: –£–¥–∞–ª—è–µ—Ç NaN, –∫–æ–¥–∏—Ä—É–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç.
- **EDA**: –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º.
- **Feature Engineering**: –°–æ–∑–¥–∞—ë—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏, —É–ª—É—á—à–∞—é—â–∏–µ –º–æ–¥–µ–ª–∏.

**–ü—Ä–∏–º–µ—Ä**: –î–∞—Ç–∞—Å–µ—Ç —Ü–µ–Ω –¥–æ–º–æ–≤ ‚Äî —É–±—Ä–∞—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏, –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å "City", –¥–æ–±–∞–≤–∏—Ç—å "Price_per_room":
```
import pandas as pd
data = {'Price': [100, None, 300], 'City': ['Moscow', 'SPb', 'Moscow'], 'Rooms': [2, 3, 4]}
df = pd.DataFrame(data)
df = df.dropna(subset=['Price'])
df = pd.get_dummies(df, columns=['City'])
df['Price_per_room'] = df['Price'] / df['Rooms']
print(df)
```

## 6. üìù –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è

1. –ó–∞–≥—Ä—É–∑–∏ –¥–∞—Ç–∞—Å–µ—Ç "Titanic".
2. –û—á–∏—Å—Ç–∏ –ø—Ä–æ–ø—É—Å–∫–∏ –≤ "Age" —Å—Ä–µ–¥–Ω–∏–º.
3. –ó–∞–∫–æ–¥–∏—Ä—É–π "Sex" (male/female) –≤ 0/1.
4. –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–π –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤ —Å—Ç–∞—Ä—à–µ 30 –ª–µ—Ç.